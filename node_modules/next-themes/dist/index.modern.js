import e,{createContext as t,useContext as n,useState as r,useCallback as o,useRef as i,useEffect as a,memo as c}from"react";import m from"next/head";var s=t({setTheme:function(e){},themes:[]}),d=function(){return n(s)},u=["light","dark"],l="(prefers-color-scheme: dark)",f=function(t){var n=t.forcedTheme,c=t.disableTransitionOnChange,m=void 0!==c&&c,d=t.enableSystem,f=void 0===d||d,g=t.enableColorScheme,T=void 0===g||g,w=t.storageKey,S=void 0===w?"theme":w,b=t.themes,E=void 0===b?["light","dark"]:b,k=t.defaultTheme,x=void 0===k?f?"system":"light":k,L=t.attribute,I=void 0===L?"data-theme":L,C=t.value,M=t.children,_=r(function(){return v(S,x)}),O=_[0],H=_[1],K=r(function(){return v(S)}),N=K[0],j=K[1],A=C?Object.values(C):E,J=o(function(e){var t=p(e);j(t),"system"!==O||n||z(t,!1)},[O,n]),P=i(J);P.current=J;var z=o(function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!0);var r=(null==C?void 0:C[e])||e,o=m&&n?y():null;if(t)try{localStorage.setItem(S,e)}catch(e){}if("system"===e&&f){var i=p();r=(null==C?void 0:C[i])||i}if(n){var a,c=document.documentElement;"class"===I?((a=c.classList).remove.apply(a,A),c.classList.add(r)):c.setAttribute(I,r),null==o||o()}},[]);a(function(){var e=function(){return P.current.apply(P,[].slice.call(arguments))},t=window.matchMedia(l);return t.addListener(e),e(t),function(){return t.removeListener(e)}},[]);var V=o(function(e){n?z(e,!0,!1):z(e),H(e)},[n]);return a(function(){var e=function(e){e.key===S&&V(e.newValue)};return window.addEventListener("storage",e),function(){return window.removeEventListener("storage",e)}},[V]),a(function(){if(T){var e=n&&u.includes(n)?n:O&&u.includes(O)?O:"system"===O&&N||null;document.documentElement.style.setProperty("color-scheme",e)}},[T,O,N,n]),e.createElement(s.Provider,{value:{theme:O,setTheme:V,forcedTheme:n,resolvedTheme:"system"===O?N:O,themes:f?[].concat(E,["system"]):E,systemTheme:f?N:void 0}},e.createElement(h,{forcedTheme:n,storageKey:S,attribute:I,value:C,enableSystem:f,defaultTheme:x,attrs:A}),M)},h=c(function(t){var n=t.forcedTheme,r=t.storageKey,o=t.attribute,i=t.enableSystem,a=t.defaultTheme,c=t.value,s="class"===o?"var d=document.documentElement.classList;d.remove("+t.attrs.map(function(e){return"'"+e+"'"}).join(",")+");":"var d=document.documentElement;",d=function(e,t){e=(null==c?void 0:c[e])||e;var n=t?e:"'"+e+"'";return"class"===o?"d.add("+n+")":"d.setAttribute('"+o+"', "+n+")"},u="system"===a;return e.createElement(m,null,e.createElement("script",n?{key:"next-themes-script",dangerouslySetInnerHTML:{__html:"!function(){"+s+d(n)+"}()"}}:i?{key:"next-themes-script",dangerouslySetInnerHTML:{__html:"!function(){try {"+s+"var e=localStorage.getItem('"+r+"');"+(u?"":d(a)+";")+'if("system"===e||(!e&&'+u+')){var t="'+l+'",m=window.matchMedia(t);m.media!==t||m.matches?'+d("dark")+":"+d("light")+"}else if(e) "+(c?"var x="+JSON.stringify(c)+";":"")+d(c?"x[e]":"e",!0)+"}catch(e){}}()"}}:{key:"next-themes-script",dangerouslySetInnerHTML:{__html:"!function(){try{"+s+'var e=localStorage.getItem("'+r+'");if(e){'+(c?"var x="+JSON.stringify(c)+";":"")+d(c?"x[e]":"e",!0)+"}else{"+d(a)+";}}catch(t){}}();"}}))},function(e,t){return e.forcedTheme===t.forcedTheme}),v=function(e,t){if("undefined"!=typeof window){var n;try{n=localStorage.getItem(e)||void 0}catch(e){}return n||t}},y=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(e),function(){window.getComputedStyle(document.body),setTimeout(function(){document.head.removeChild(e)},1)}},p=function(e){return e||(e=window.matchMedia(l)),e.matches?"dark":"light"};export{f as ThemeProvider,d as useTheme};
